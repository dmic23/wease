var StringMask=function(){var e={0:{pattern:/\d/,_default:"0"},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,optional:!0,recursive:!0},S:{pattern:/[a-zA-Z]/},$:{escape:!0}},t=function(t,n){for(var i=0,r=n-1,s={escape:!0};r>=0&&s&&s.escape;)s=e[t.charAt(r)],i+=s&&s.escape?1:0,r--;return i>0&&i%2===1},n=function(e,t){var n=e.replace(/[^0]/g,"").length,i=t.replace(/[^\d]/g,"").length;return i-n},i=function(e,t,n){return n.reverse?t+e:e+t},r=function(t,n,i){var s=t.charAt(n),o=e[s];return""===s?!1:o&&!o.escape?!0:r(t,n+i,i)},s=function(e,t,n){var i=e.split("");return i.splice(n>=0?n:0,0,t),i.join("")},o=function(p,u){this.options=u||{},this.options={reverse:this.options.reverse||!1,usedefaults:this.options.usedefaults||this.options.reverse},this.pattern=p,o.prototype.process=function(o){if(!o)return"";o+="";for(var p=this.pattern,u=!0,a="",c=this.options.reverse?o.length-1:0,f=n(p,o),h=!1,l=[],v=!1,d={start:this.options.reverse?p.length-1:0,end:this.options.reverse?-1:p.length,inc:this.options.reverse?-1:1},g=function(e){if(!v&&r(p,y,d.inc))return!0;if(v||(v=l.length>0),v){var t=l.shift();if(l.push(t),e.reverse&&c>=0)return y++,p=s(p,t,y),!0;if(!e.reverse&&c<o.length)return p=s(p,t,y),!0}return y<p.length&&y>=0},y=d.start;g(this.options);y+=d.inc){var b=p.charAt(y),A=o.charAt(c),j=e[b];if(!v||A){if(this.options.reverse&&t(p,y)){a=i(a,b,this.options),y+=d.inc;continue}if(!this.options.reverse&&h){a=i(a,b,this.options),h=!1;continue}if(!this.options.reverse&&j&&j.escape){h=!0;continue}}if(!v&&j&&j.recursive)l.push(b);else{if(v&&!A){j&&j.recursive||(a=i(a,b,this.options));continue}if(l.length>0&&j&&!j.recursive){u=!1;continue}if(!v&&l.length>0&&!A)continue}if(j)if(j.optional){if(j.pattern.test(A)&&f)a=i(a,A,this.options),c+=d.inc,f--;else if(l.length>0&&A){u=!1;break}}else if(j.pattern.test(A))a=i(a,A,this.options),c+=d.inc;else{if(A||!j._default||!this.options.usedefaults){u=!1;break}a=i(a,j._default,this.options)}else a=i(a,b,this.options),!v&&l.length&&l.push(b)}return{result:a,valid:u}},o.prototype.apply=function(e){return this.process(e).result},o.prototype.validate=function(e){return this.process(e).valid}};return o.process=function(e,t,n){return new o(t,n).process(e)},o.apply=function(e,t,n){return new o(t,n).apply(e)},o.validate=function(e,t,n){return new o(t,n).validate(e)},o}(),objectTypes={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1};objectTypes[typeof module]&&(module.exports=StringMask);