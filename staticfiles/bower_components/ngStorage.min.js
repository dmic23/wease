!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["angular"],t):"object"==typeof exports?module.exports=t(require("angular")):t(e.angular)}(this,function(e){"use strict";function t(t){return function(){var n="ngStorage-";this.setKeyPrefix=function(e){if("string"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setKeyPrefix() expects a String.");n=e};var r=e.toJson,o=e.fromJson;this.setSerializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setSerializer expects a function.");r=e},this.setDeserializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setDeserializer expects a function.");o=e},this.get=function(e){return o(window[t].getItem(n+e))},this.set=function(e,o){return window[t].setItem(n+e,r(o))},this.$get=["$rootScope","$window","$log","$timeout",function(i,a,s,c){function u(e){var t;try{t=a[e]}catch(n){t=!1}if(t&&"localStorage"===e){var r="__"+Math.round(1e7*Math.random());try{localStorage.setItem(r,r),localStorage.removeItem(r)}catch(n){t=!1}}return t}var f,l,d=n.length,g=u(t)||(s.warn("This browser does not support Web Storage!"),{setItem:e.noop,getItem:e.noop}),p={$default:function(t){for(var n in t)e.isDefined(p[n])||(p[n]=t[n]);return p.$sync(),p},$reset:function(e){for(var t in p)"$"===t[0]||delete p[t]&&g.removeItem(n+t);return p.$default(e)},$sync:function(){for(var e,t=0,r=g.length;r>t;t++)(e=g.key(t))&&n===e.slice(0,d)&&(p[e.slice(d)]=o(g.getItem(e)))},$apply:function(){var t;if(l=null,!e.equals(p,f)){t=e.copy(f),e.forEach(p,function(o,i){e.isDefined(o)&&"$"!==i[0]&&(g.setItem(n+i,r(o)),delete t[i])});for(var o in t)g.removeItem(n+o);f=e.copy(p)}}};return p.$sync(),f=e.copy(p),i.$watch(function(){l||(l=c(p.$apply,100,!1))}),a.addEventListener&&a.addEventListener("storage",function(t){n===t.key.slice(0,d)&&(t.newValue?p[t.key.slice(d)]=o(t.newValue):delete p[t.key.slice(d)],f=e.copy(p),i.$apply())}),a.addEventListener&&a.addEventListener("beforeunload",function(){p.$apply()}),p}]}}return e=e&&e.module?e:window.angular,e.module("ngStorage",[]).provider("$localStorage",t("localStorage")).provider("$sessionStorage",t("sessionStorage"))});